# Development Setup Guide

## 📱 Mobile Platform Development

### ❓ Why Android/iOS folders are not in Git?

For this project, we **exclude** `client/android/` and `client/ios/` directories from Git for these reasons:

1. **🔄 Auto-generated**: These folders are generated by Capacitor (`npx cap add android/ios`)
2. **📦 Large size**: Contains build artifacts, dependencies, and generated files
3. **🤝 Team consistency**: Each developer can generate identical native projects

### ⚙️ Setup Process for New Developers

When you clone this repository, follow these steps:

#### 1. **Generate Native Platforms**
```bash
cd client/
npm install
npx cap add android
npx cap add ios
```

#### 2. **Apply Network Configurations** 
```bash
# Run our automated setup script
./scripts/setup-mobile-config.sh
```

#### 3. **Sync Changes**
```bash
npx cap sync
```

#### 4. **Build and Test**
```bash
# For Android
npx cap open android

# For iOS  
npx cap open ios
```

### 🔧 What the Setup Script Does

The `setup-mobile-config.sh` script automatically configures:

#### **Android Configuration**
- ✅ Adds `usesCleartextTraffic="true"` to AndroidManifest.xml
- ✅ Creates `network_security_config.xml` for HTTP development servers
- ✅ Adds Internet permission

#### **iOS Configuration**  
- ✅ Configures `NSAppTransportSecurity` in Info.plist
- ✅ Allows insecure HTTP loads for development
- ✅ Adds local network usage description

### 📝 Files Under Version Control

**✅ Committed to Git:**
- `capacitor.config.ts` - Main Capacitor configuration
- `scripts/setup-mobile-config.sh` - Automated setup script
- All TypeScript/HTML/CSS source code

**❌ Excluded from Git:**
- `client/android/` - Android native project
- `client/ios/` - iOS native project  
- `client/.capacitor/` - Capacitor cache

### 🚀 Development Workflow

#### For existing project:
```bash
git pull                                    # Get latest changes
cd client/
npm install                                # Install dependencies  
npx cap sync                              # Sync web assets to native
```

#### For fresh clone:
```bash
git clone <repository>
cd client/
npm install
npx cap add android && npx cap add ios    # Generate platforms
./scripts/setup-mobile-config.sh         # Apply configurations
npx cap sync                              # Sync everything
```

### 🔍 Troubleshooting

#### Network Issues on Mobile
If you encounter network connection problems:

1. **Check server is running**: `dotnet run` in `server/` directory
2. **Verify API URLs** in `src/app/services/todo.service.ts`:
   - Android emulator: `http://10.0.2.2:8080`
   - iOS simulator: `http://192.168.1.91:8080` 
   - Physical devices: `http://192.168.1.91:8080`

3. **Re-run setup script**: `./scripts/setup-mobile-config.sh`
4. **Clean and rebuild**: Remove platforms and regenerate

#### Script Permissions
If setup script fails:
```bash
chmod +x scripts/setup-mobile-config.sh
```

### 💡 Alternative Approaches

If you prefer different approaches:

#### **Option A: Commit Key Configuration Files**
You could selectively commit important native files by modifying `.gitignore`:
```gitignore
# Instead of excluding entire directories:
client/android/
!client/android/app/src/main/AndroidManifest.xml
!client/android/app/src/main/res/xml/network_security_config.xml

client/ios/  
!client/ios/App/App/Info.plist
```

#### **Option B: Manual Configuration**
Follow the mobile build guides in:
- `client/BUILD_ANDROID.md`
- `client/BUILD_IOS.md`

### 🏆 Benefits of Current Approach

✅ **Clean Git history** - No build artifacts or generated files  
✅ **Automated setup** - One script configures everything  
✅ **Cross-platform consistency** - Same setup on all machines  
✅ **Easy maintenance** - Update script instead of many files  
✅ **Onboarding friendly** - Clear steps for new developers
